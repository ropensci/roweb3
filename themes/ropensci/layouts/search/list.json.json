[
  {{ range $index, $page := ( where .Site.RegularPages "Type" "in" .Site.Params.search ) }}
{{- if ne $page.Type "json" -}}
{{- if and $index (gt $index 0) -}},{{- end }}
{{ $description := $page.Description }}
{
  "type": "{{ $page.Type }}",
	"path": "{{ $page.RelPermalink }}",
	"title": "{{ htmlEscape $page.Title}}",
	"description": "{{ $description | chomp | htmlEscape }}",
	"tags": "{{ $page.Params.tags }}"
}
{{- end -}}
{{- end -}},
{{ range $index, $page := ( where .Site.Pages "Type" "in" .Site.Params.projects ) }}
{{- if and $index (gt $index 0) -}},{{- end }}
{{ $description := $page.Description }}
{
  "type": "project",
	"path": "{{ $page.RelPermalink }}",
	"title": "{{ htmlEscape $page.Title}}",
	"description": "{{ $description | chomp | htmlEscape }}",
	"tags": "{{ $page.Params.tags }}"
}
{{- end -}},
{{ $registry := getJSON "https://ropensci.github.io/roregistry/registry.json" }}
{{ range $index, $page := $registry.packages }}
{{- if and $index (gt $index 0) -}},{{- end }}
{
  "type": "package",
	"path": "https://docs.ropensci.org/{{ $page.name }}",
	"title": "{{ $page.name}} - {{ $page.description | chomp | replaceRE "\n" "" | htmlEscape }}",
	"description": "",
	"tags": ""
}
{{- end -}}
]